<%= render partial: "admin/manage/header" %>

<% column_width = browser.mobile? ? "col-6" : "col-4" %>


<h4 class="pageH p-1 px-2 mb-0 rounded-top d-flex align-items-center bg-dark text-light"><%= icon(icon:"tags", lbl: "Manage and edit tags", with_span: true) %>

<div class="d-flex ms-auto">
<% @sortbys.each do |sortby| %>
<%= link_to sortby, {sortby:sortby}, class:"mx-1 nodec fs-6 px-1 rounded #{@sortby == sortby ? "bg-white border" : ""}" %>
<% end %>
</div>
</h4>
<div class="bg-light border p-2">

	<% if @tag %>
	<%= simple_form_for(@tag, url: feedbacker.update_tag_path(@tag)) do |f| %>
	<div class="d-flex align-items-center">
		<%= f.input :name, input_html: { name: 'tag[name]', class: "form-control form-control-sm" }  %>
		<%= f.button :submit, class: "btn btn-sm btn-primary mx-1" %>
	</div>
	<% end %>
	<% end %>

	<div class="d-flex flex-wrap">
		<% @tags.each do |tag| %>
		<div class="<%= column_width %> p-1 d-flex">
			<div class="bg-white border p-1 d-flex flex-fill">
			<a class="d-flex flex-fill align-items-center fw-bold nodec" href="<%= admin_tags_path(id:tag.id) %>"><%= tag.name %>
				<span class="ms-auto me-1 badge bg-light border text-dark p-sm"><%= tag.taggings_count %></span>
			</a>
			<%= link_to icon(icon:"trash"), feedbacker.destroy_tag_path(id:tag.id), method: :delete, class:"ms-auto text-muted fs-7", data: { confirm: 'Are you sure?' } %>
			</div>
		</div>
		<% end %>
	</div>

	<div class="text-center" id="tags_chart">
		<h4 class="mt-4">Tags per book</h4>
		<form method="get" action="#tags_chart">
			<input type="text" name="top" value="<%= @top %>"/><input type="submit" value="filter">
		</form>


		<%= pie_chart @grouped_tags_top %> <%#, title: "Books by tag (top)" %>
		<%= pie_chart @grouped_tags, title: "Books by tag (all)" %>
	</div>


</div>